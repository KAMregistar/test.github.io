<!DOCTYPE html>
<html lang="hr">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Tiskana knjiga u više svezaka</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400&family=Rubik:wght@300&display=swap" rel="stylesheet"/>
<link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css">
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

<!-- RDF/Turtle + XLSX biblioteke (ostaju kao i prije) -->
<script src="https://unpkg.com/n3/browser/n3.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<link href="style.css" rel="stylesheet"/>
<style>
  * { box-sizing: border-box; }
  body { margin:0; font-family: Poppins, system-ui, Segoe UI, Roboto, Arial, sans-serif; color:#1f2937; background:#f6f7fb; }

  #menu-bar { display:flex; align-items:center; gap:20px; padding:10px 16px; border-bottom:1px solid #e5e7eb; background:#fff; position:sticky; top:0; z-index:100; }
  #menu-bar .logo { height:36px; width:auto; }
  #menu-bar h1 { margin:0; font-size:18px; font-weight:600; }
  #menu-bar > div { position:relative; font-size:14px; cursor:default; }
  #menu-bar .dropdown { position:absolute; top:20px; left:0; min-width:240px; background:#fff; border:1px solid #e5e7eb; border-radius:0px; padding:8px; display:none; max-height:320px; overflow:auto; box-shadow: 0 6px 24px rgba(0,0,0,0.08); }
  #menu-bar > div:hover .dropdown { display:block; }
  #menu-bar .dropdown div { padding:8px; border-radius:8px; }
  #menu-bar .dropdown div:hover { background:#f3f4f6; }

  #content { max-width:1100px; margin:16px auto; padding:0 16px 20px; }

  .card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:16px;margin:14px 0}
  .row{display:grid;grid-template-columns:repeat(12, minmax(0,1fr));gap:12px}
  label{font-size:13px;color:#111827}
  input,select,textarea{width:100%;padding:10px 12px;border:1px solid #94a3b8;border-radius:0px;background:#fff}

  .cols-12{grid-column:span 12}
  .cols-8{grid-column:span 8}
  .cols-6{grid-column:span 6}
  .cols-4{grid-column:span 4}
  .cols-3{grid-column:span 3}
  .cols-2{grid-column:span 2}

  .actions{display:flex;flex-wrap:wrap;gap:10px;justify-content:flex-end;padding:10px 0}
  button{appearance:none;border:0;border-radius:0px;padding:10px 16px;cursor:pointer}
  .primary{background:#6d28d9;color:#fff}
  .ghost{background:transparent;border:1px solid #e5e7eb}
  pre.output{white-space:pre-wrap;background:#0b1020;color:#cfe8ff;border-radius:12px;padding:14px;overflow:auto}

  @media (max-width: 980px){
    .cols-8,.cols-6,.cols-4,.cols-3,.cols-2{grid-column:span 12}
    #menu-bar h1{display:none}
  }
  .card h2, 
  .card h3 {
    background: #eee;
    margin: -16px -16px 12px -16px;
    padding: 10px 16px;
    border-bottom: 1px solid #e5e7eb;
    border-radius: 0px 0px 0 0;
    font-size: 16px;
    font-weight: 600;
  }

  /* help ikona + modal */
  .help-icon { font-size: 16px; margin-left: 8px; cursor: pointer; color: red; }
  .help-icon:hover { color: darkred; }
  .help-modal { display:none; position:fixed; z-index:2000; left:0; top:0; width:100%; height:100%; background-color:rgba(0,0,0,0.4); }
  .help-content { background:#fff; margin:10% auto; padding:20px; border-radius:10px; width:420px; box-shadow:0 6px 18px rgba(0,0,0,0.2); font-size:14px; }
  .help-close { float:right; font-size:20px; font-weight:bold; cursor:pointer; color:#666; }
  .help-close:hover { color:#000; }

  /* mali ljubičasti button u naslovima */
  .small-btn{font-size:12px;padding:4px 10px;margin-left:8px;background:#6a0dad;color:#fff;border:none;border-radius:4px;cursor:pointer}
  .small-btn:hover{background:#5a009e}

  /* pristupačna skrivena labela za klonove */
  .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
</style>
</head>
<body>

<!-- gornji meni (nepromijenjen) -->
<div id="menu-bar">
  <img alt="KAM Logo" class="logo" src="kam.png"/>
  <h1><a href="index.html" style="text-decoration:none; color:inherit;">Registar</a>          </h1>
  <div>KLASE <div class="dropdown" id="klase-dropdown"></div></div>
  <div>SVOJSTVA <div class="dropdown" id="svojstva-dropdown"></div></div>
  <div id="prefiksi">PREFIKSI</div>
  <div>Pomoć</div>
</div>

<div id="content">
  <h2>Unos tiskane knjige u više svezaka</h2>

  <form id="kamForm" onsubmit="return false">
    <!-- 1. STVARNI PRIKAZ -->
    <section class="card">
      <h3>
        1. Stvarni prikaz
        <span class="help-icon" onclick="openHelp('help1')">ℹ</span>
        <button class="small-btn" type="button" onclick="window.open('https://pravilnik.kam.hr/index.php?action=chapter&id=16','_blank')">
          KAM Pravilnik - Stvarni prikaz jedinice građe
        </button>
      </h3>

      <div class="row">
        <div class="cols-12">
          <label for="e1_1">1.1 Stvarni prikaz</label>
          <input id="e1_1" />
        </div>

        <!-- ✳︎✳︎ NOVO: wrapper + gumb + template za višestruke napomene ✳︎✳︎ -->
        <div class="cols-12" id="e1_2_wrapper">
          <label for="e1_2">1.2 Napomena o stvarnom prikazu</label>
          <textarea id="e1_2" name="e1_2[]"></textarea>
          <div style="margin-top:8px">
            <button type="button" class="ghost" onclick="addNote('e1_2_wrapper','e1_2')">+ Dodaj napomenu</button>
          </div>
        </div>

        <template id="tpl-e1_2">
          <div class="extra-note" style="margin-top:10px">
            <label class="sr-only"></label>
            <textarea></textarea>
            <div style="margin-top:6px">
              <button type="button" class="ghost" onclick="removeNote(this)">Ukloni</button>
            </div>
          </div>
        </template>
        <!-- ✳︎✳︎ KRAJ NOVO ✳︎✳︎ -->

        <div class="cols-4">
          <label for="e1_3">1.3 Podatak o stvarnom naslovu</label>
          <input id="e1_3" />
        </div>
        <div class="cols-4">
          <label for="e1_4">1.4 Glavni stvarni naslov</label>
          <input id="e1_4" />
        </div>
        <div class="cols-4">
          <label for="e1_5">1.5 Usporedni stvarni naslov</label>
          <input id="e1_5" />
        </div>
        <div class="cols-6">
          <label for="e1_6">1.6 Dodatak glavnom stvarnom naslovu</label>
          <input id="e1_6" />
        </div>
        <div class="cols-6">
          <label for="e1_7">1.7 Usporedni dodatak glavnom stvarnom naslovu</label>
          <input id="e1_7" />
        </div>
        <div class="cols-12">
          <label for="e1_8">1.8 Napomena o stvarnom naslovu</label>
          <textarea id="e1_8"></textarea>
        </div>
        <div class="cols-6">
          <label for="e1_9">1.9 Podatak o odgovornosti koji se odnosi na stvarni naslov</label>
          <input id="e1_9" />
        </div>
        <div class="cols-6">
          <label for="e1_10">1.10 Usporedni podatak o odgovornosti koji se odnosi na stvarni naslov</label>
          <input id="e1_10" />
        </div>
        <div class="cols-12">
          <label for="e1_11">1.11 Napomena o odgovornosti koja se odnosi stvarni naslov</label>
          <textarea id="e1_11"></textarea>
        </div>
        <div class="cols-3">
          <label for="e1_12">1.12 Podatak o izdanju</label>
          <input id="e1_12" />
        </div>
        <div class="cols-3">
          <label for="e1_13">1.13 Oznaka izdanja</label>
          <input id="e1_13" />
        </div>
        <div class="cols-3">
          <label for="e1_14">1.14 Usporedna oznaka izdanja</label>
          <input id="e1_14" />
        </div>
        <div class="cols-3">
          <label for="e1_15">1.15 Dodatna oznaka izdanja</label>
          <input id="e1_15" />
        </div>
        <div class="cols-3">
          <label for="e1_16">1.16 Usporedna dodatna oznaka izdanja</label>
          <input id="e1_16" />
        </div>
        <div class="cols-4">
          <label for="e1_17">1.17 Podatak o odgovornosti koji se odnosi na izdanje</label>
          <input id="e1_17" />
        </div>
        <div class="cols-4">
          <label for="e1_18">1.18 Usporedni podatak o odgovornosti koji se odnosi na izd.</label>
          <input id="e1_18" />
        </div>
        <div class="cols-12">
          <label for="e1_19">1.19 Napomena o izdanju</label>
          <textarea id="e1_19"></textarea>
        </div>
        <div class="cols-6">
          <label for="e1_20">1.20 Podatak o izdavanju, proizvodnji ili raspačavanju</label>
          <input id="e1_20" />
        </div>
        <div class="cols-6">
          <label for="e1_21">1.21 Ime mjesta izdavanja, proizvodnje ili raspačavanja</label>
          <input id="e1_21" />
        </div>
        <div class="cols-6">
          <label for="e1_22">1.22 Usporedno ime mjesta izdavanja, proizvodnje ili raspačavanja</label>
          <input id="e1_22" />
        </div>
        <div class="cols-6">
          <label for="e1_23">1.23 Ime nakladnika, proizvođača ili raspačavatelja</label>
          <input id="e1_23" />
        </div>
        <div class="cols-6">
          <label for="e1_24">1.24 Usporedno ime nakladnika, proizvođača ili raspačavatelja</label>
          <input id="e1_24" />
        </div>
        <div class="cols-6">
          <label for="e1_25">1.25 Oznaka godine izdavanja, proizvodnje ili raspačavanja</label>
          <input id="e1_25" />
        </div>
        <div class="cols-12">
          <label for="e1_26">1.26 Napomena o izdavanju, proizvodnji ili raspačavanju</label>
          <textarea id="e1_26"></textarea>
        </div>
        <div class="cols-3">
          <label for="e1_27">1.27 Podatak o tiskanju ili izradi</label>
          <input id="e1_27" />
        </div>
        <div class="cols-3">
          <label for="e1_28">1.28 Ime mjesta tiskanja ili izrade</label>
          <input id="e1_28" />
        </div>
        <div class="cols-3">
          <label for="e1_29">1.29 Ime tiskara ili izrađivača</label>
          <input id="e1_29" />
        </div>
        <div class="cols-3">
          <label for="e1_30">1.30 Oznaka godine tiskanja ili izrade</label>
          <input id="e1_30" />
        </div>
        <div class="cols-12">
          <label for="e1_31">1.31 Napomena o tiskanju ili izradi</label>
          <textarea id="e1_31"></textarea>
        </div>
        <div class="cols-12">
          <label for="e1_32">1.32 Oznaka godine copyrighta</label>
          <input id="e1_32" />
        </div>
        <div class="cols-12">
          <label for="e1_33">1.33 Napomena o copyrightu</label>
          <textarea id="e1_33"></textarea>
        </div>
        <div class="cols-6">
          <label for="e1_34">1.34 Podatak o nakladničkoj cjelini</label>
          <input id="e1_34" />
        </div>
        <div class="cols-6">
          <label for="e1_35">1.35 Stvarni naslov nakladničke cjeline</label>
          <input id="e1_35" />
        </div>
        <div class="cols-6">
          <label for="e1_36">1.36 Podatak o odgovornosti koji se odnosi na nakladničku cjelinu</label>
          <input id="e1_36" />
        </div>
        <div class="cols-6">
          <label for="e1_37">1.37 Međunarodni standardni broj nakladničke cjeline</label>
          <input id="e1_37" />
        </div>
        <div class="cols-12">
          <label for="e1_38">1.38 Numeracija u nakladničkoj cjelini</label>
          <input id="e1_38" />
        </div>
        <div class="cols-12">
          <label for="e1_39">1.39 Napomena o nakladničkoj cjelini</label>
          <textarea id="e1_39"></textarea>
        </div>
      </div>
    </section>

    <!-- OSTALE SEKCIJE (2,3,4,5,6,10) — ostavljene identične kao do sada -->
    <!-- Tvoj dosadašnji HTML za sekcije 2,3,4,5,6 i 10 ovdje se NE mijenja.
         Ako želiš, samo zalijepi svoje postojeće blokove bez promjena. -->

    <section class="card">
      <h3>… ostatak tvojih sekcija (2–10) …</h3>
      <!-- Zalijepi svoje dosadašnje sekcije ovdje -->
    </section>

    <div class="actions">
      <button class="ghost" id="testBtn" type="button">Test</button>
      <button class="primary" id="genBtn" type="button">Generiraj JSON-LD</button>
      <button class="primary" id="genTurtleBtn" type="button">Generiraj Turtle</button>
      <button class="primary" id="genRdfBtn" type="button">Generiraj RDF/XML</button>
      <button class="primary" id="genXlsBtn" type="button">Generiraj XLSX</button>
    </div>
  </form>

  <details class="card" open="">
    <summary><strong>Rezultat</strong> (generirani izlaz)</summary>
    <pre aria-live="polite" class="output" id="output"></pre>
    <a download="podaci.xlsx" id="downloadLink" style="display:none;">Preuzmi XLSX</a>
    <div class="hint" id="error" style="color:#b91c1c"></div>
  </details>
</div>

<div id="footer" style="background:#111;color:#fff;padding:12px 16px;font-size:12px">
  © 2024 Nacionalna i sveučilišna knjižnica u Zagrebu. Sva prava pridržana.
</div>

<!-- HELP modali (ostavi svoje postojeće) -->
<div class="help-modal" id="help1"><div class="help-content"><span class="help-close" onclick="closeHelp('help1')">×</span><h4>Uputa: 1. Stvarni prikaz</h4><p>…</p></div></div>

<script>
  /* HELP otvaranje/zatvaranje (kao i prije) */
  function openHelp(id){ document.getElementById(id).style.display="block"; }
  function closeHelp(id){ document.getElementById(id).style.display="none"; }
  window.onclick = function(e){
    document.querySelectorAll('.help-modal').forEach(m=>{ if(e.target===m) m.style.display="none"; });
  };

  /* ====== NOVO: višestruke napomene za 1.2 ====== */
  function addNote(wrapperId, baseId){
    const wrapper = document.getElementById(wrapperId);
    const tpl = document.getElementById('tpl-' + baseId);
    if(!wrapper || !tpl) return;

    const count = wrapper.querySelectorAll('textarea').length; // uključuje i glavnu
    const clone = tpl.content.firstElementChild.cloneNode(true);

    const ta  = clone.querySelector('textarea');
    const lbl = clone.querySelector('label');

    const newId = `${baseId}__${count}`;
    ta.id   = newId;
    ta.name = baseId + '[]';  // polje kao array
    lbl.setAttribute('for', newId);
    lbl.textContent = `Dodatna napomena ${count}`;

    wrapper.appendChild(clone);
  }
  function removeNote(btn){
    const holder = btn.closest('.extra-note');
    if (holder) holder.remove();
  }
</script>

<!-- TVOJ POSTOJEĆI JS za generiranje JSON-LD / Turtle / RDF / XLSX ostaje nepromijenjen -->
<!-- (Ako je u posebnom .js, samo ga i dalje uključuj kao i prije) -->

</body>
</html>
